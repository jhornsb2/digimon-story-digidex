<div class="digimon-detail-dialog">
  <div mat-dialog-title class="dialog-header">
    <div class="title-section">
      <img [src]="getDigimonIconPath(digimon)" [alt]="digimon.name + ' icon'" class="digimon-icon" />
      <div>
        <h2>#{{ digimon.fieldGuideNumber.toString().padStart(3, '0') }} {{ digimon.name }}</h2>
        <mat-chip [class]="getStageClass(digimon.stage)">
          {{ stages[digimon.stage] }}
        </mat-chip>
      </div>
    </div>
    <button mat-icon-button mat-dialog-close>
      <mat-icon>close</mat-icon>
    </button>
  </div>

  <div mat-dialog-content class="dialog-content">
    <mat-tab-group>
      <mat-tab label="Overview">
        <div class="tab-content">
          <div class="stats-grid">
            <div class="stat-item">
              <div class="stat-label">Attribute</div>
              <div class="stat-value">
                <mat-chip [class]="getAttributeClass(digimon.attribute)">
                  {{ attributes[digimon.attribute] }}
                </mat-chip>
              </div>
            </div>

            <div class="stat-item">
              <div class="stat-label">Type</div>
              <div class="stat-value">
                <mat-chip [class]="getTypeClass(digimon.type)">
                  {{ digimonTypes[digimon.type] }}
                </mat-chip>
              </div>
            </div>

            <div class="stat-item">
              <div class="stat-label">Memory Usage</div>
              <div class="stat-value">{{ digimon.memoryUsage }}</div>
            </div>

            <div class="stat-item">
              <div class="stat-label">Equipment Slots</div>
              <div class="stat-value">{{ digimon.equipmentSlots }}</div>
            </div>
          </div>

          <div class="description-section">
            <h3>Description</h3>
            <p class="description">{{ digimon.description }}</p>
          </div>

          <div class="support-skill-section" *ngIf="digimon.supportSkill">
            <h3>Support Skill</h3>
            <div class="support-skill-card">
              <h4>{{ digimon.supportSkill.name }}</h4>
              <p>{{ digimon.supportSkill.description }}</p>
            </div>
          </div>
        </div>
      </mat-tab>

      <mat-tab label="Skills">
        <div class="tab-content">
          <div class="skills-list" *ngIf="getSkillsArray().length > 0; else noSkills">
            <div *ngFor="let skill of getSkillsArray()" class="skill-item">
              <div class="skill-header">
                <span class="skill-name">{{ skill.name }}</span>
                <mat-chip [class]="getSkillTypeClass(skill.skillType)">
                  {{ skill.skillType }}
                </mat-chip>
              </div>
              <div class="skill-details">
                <span class="skill-stat">SP: {{ skill.spCost }}</span>
                <span class="skill-stat" *ngIf="skill.power > 0">Power: {{ skill.power }}</span>
                <mat-chip [class]="getAttributeClass(skill.attribute)" class="skill-attribute">
                  {{ skill.attribute }}
                </mat-chip>
              </div>
              <p class="skill-description">{{ skill.description }}</p>
            </div>
          </div>
          <ng-template #noSkills>
            <p class="no-data">No skills available for this Digimon.</p>
          </ng-template>
        </div>
      </mat-tab>

      <mat-tab label="Digivolution">
        <div class="tab-content">
          <div class="digivolution-section" *ngIf="digimon.digivolvesFrom && digimon.digivolvesFrom.length > 0">
            <h3>Digivolves From</h3>
            <div class="digivolution-list">
              <mat-chip *ngFor="let from of digimon.digivolvesFrom" class="digivolution-chip">
                {{ from.name }}
              </mat-chip>
            </div>
          </div>

          <div class="digivolution-section" *ngIf="digimon.digivolvesTo && digimon.digivolvesTo.length > 0">
            <h3>Digivolves To</h3>
            <div class="digivolution-list">
              <mat-chip *ngFor="let to of digimon.digivolvesTo" class="digivolution-chip">
                {{ to.name }}
              </mat-chip>
            </div>
          </div>

          <div class="requirements-section" *ngIf="digimon.digivolutionRequirements">
            <h3>Digivolution Requirements</h3>
            <div class="requirements-grid">
              <div class="requirement" *ngIf="digimon.digivolutionRequirements.level">
                <span class="req-label">Level:</span>
                <span class="req-value">{{ digimon.digivolutionRequirements.level }}</span>
              </div>
              <div class="requirement" *ngIf="digimon.digivolutionRequirements.stats">
                <span class="req-label">Stats:</span>
                <div class="stats-reqs">
                  <span
                    *ngFor="let stat of getStatRequirements(digimon.digivolutionRequirements.stats)"
                    class="stat-req"
                  >
                    {{ stat }}
                  </span>
                </div>
              </div>
            </div>
          </div>

          <div
            *ngIf="
              (!digimon.digivolvesFrom || digimon.digivolvesFrom.length === 0) &&
              (!digimon.digivolvesTo || digimon.digivolvesTo.length === 0)
            "
            class="no-data"
          >
            No digivolution information available.
          </div>
        </div>
      </mat-tab>
    </mat-tab-group>
  </div>

  <div mat-dialog-actions class="dialog-actions">
    <button mat-button mat-dialog-close>Close</button>
  </div>
</div>
