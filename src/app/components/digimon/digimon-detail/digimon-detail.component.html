<div class="digimon-detail-dialog">
  <div mat-dialog-title class="dialog-header">
    <div class="title-section">
      <img [src]="getDigimonIconPath(digimon)" [alt]="digimon.name + ' icon'" class="digimon-icon" />
      <div>
        <h2>#{{ digimon.fieldGuideNumber.toString().padStart(3, '0') }} {{ digimon.name }}</h2>
        <mat-chip [class]="getStageClass(digimon.stage)">
          {{ stages[digimon.stage] }}
        </mat-chip>
      </div>
    </div>
    <button mat-icon-button mat-dialog-close>
      <mat-icon>close</mat-icon>
    </button>
  </div>

  <div mat-dialog-content class="dialog-content">
    <mat-tab-group>
      <mat-tab label="Overview">
        <div class="tab-content">
          <div class="stats-grid">
            <div class="stat-item">
              <div class="stat-label">Attribute</div>
              <div class="stat-value">
                <mat-chip [class]="getAttributeClass(digimon.attribute)">
                  {{ attributes[digimon.attribute] }}
                </mat-chip>
              </div>
            </div>

            <div class="stat-item">
              <div class="stat-label">Type</div>
              <div class="stat-value">
                <mat-chip [class]="getTypeClass(digimon.type)">
                  {{ digimonTypes[digimon.type] }}
                </mat-chip>
              </div>
            </div>

            <div class="stat-item">
              <div class="stat-label">Memory Usage</div>
              <div class="stat-value">{{ digimon.memoryUsage }}</div>
            </div>

            <div class="stat-item">
              <div class="stat-label">Equipment Slots</div>
              <div class="stat-value">{{ digimon.equipmentSlots }}</div>
            </div>
          </div>

          <div class="description-section">
            <h3>Description</h3>
            <p class="description">{{ digimon.description }}</p>
          </div>

          @if (digimon.supportSkill) {
            <div class="support-skill-section">
              <h3>Support Skill</h3>
              <div class="support-skill-card">
                <h4>{{ digimon.supportSkill.name }}</h4>
                <p>{{ digimon.supportSkill.description }}</p>
              </div>
            </div>
          }
        </div>
      </mat-tab>

      <mat-tab label="Skills">
        <div class="tab-content">
          @if (getSkillsArray().length === 0) {
            <p>No skills available for this Digimon.</p>
          } @else {
            <div class="skills-list">
              @for (skill of getSkillsArray(); track skill.name) {
                <div class="skill-item">
                  <div class="skill-header">
                    <span class="skill-name">{{ skill.name }}</span>
                    <mat-chip [class]="getSkillTypeClass(skill.skillType)">
                      {{ skillTypes[skill.skillType] }}
                    </mat-chip>
                  </div>
                  <div class="skill-details">
                    <span class="skill-stat">SP: {{ skill.spCost }}</span>
                    @if (skill.power > 0) {
                      <span class="skill-stat">Power: {{ skill.power }}</span>
                    }
                    <mat-chip [class]="getAttributeClass(skill.attribute)" class="skill-attribute">
                      {{ attributes[skill.attribute] }}
                    </mat-chip>
                  </div>
                  <p class="skill-description">{{ skill.description }}</p>
                </div>
              }
            </div>
          }
        </div>
      </mat-tab>

      <mat-tab label="Digivolution">
        <div class="tab-content">
          @if (digimon.digivolvesFrom.length > 0) {
            <div class="digivolution-section">
              <h3>Digivolves From</h3>
              <div class="digivolution-list">
                @for (from of digimon.digivolvesFrom; track from.name) {
                  <mat-chip class="digivolution-chip">
                    {{ from.name }}
                  </mat-chip>
                }
              </div>
            </div>
          }

          @if (digimon.digivolvesTo.length > 0) {
            <div class="digivolution-section">
              <h3>Digivolves To</h3>
              <div class="digivolution-list">
                @if (digimon.digivolvesTo && digimon.digivolvesTo.length > 0) {
                  @for (to of digimon.digivolvesTo; track to.name) {
                    <mat-chip class="digivolution-chip">
                      {{ to.name }}
                    </mat-chip>
                  }
                }
              </div>
            </div>
          }

          @if (digimon.digivolutionRequirements) {
            <div class="requirements-section">
              <h3>Digivolution Requirements</h3>
              <div class="requirements-grid">
                @if (digimon.digivolutionRequirements.level) {
                  <div class="requirement">
                    <span class="req-label">Level:</span>
                    <span class="req-value">{{ digimon.digivolutionRequirements.level }}</span>
                  </div>
                }

                @if (digimon.digivolutionRequirements.stats) {
                  <div class="requirement">
                    <span class="req-label">Stats:</span>
                    <div class="stats-reqs">
                      @for (stat of getStatRequirements(digimon.digivolutionRequirements.stats); track stat) {
                        <span class="stat-req">
                          {{ stat }}
                        </span>
                      }
                    </div>
                  </div>
                }
              </div>
            </div>
          }

          @if (
            (!digimon.digivolvesFrom || digimon.digivolvesFrom.length === 0) &&
            (!digimon.digivolvesTo || digimon.digivolvesTo.length === 0)
          ) {
            <div class="no-data">No digivolution information available.</div>
          }
        </div>
      </mat-tab>
    </mat-tab-group>
  </div>

  <div mat-dialog-actions class="dialog-actions">
    <button mat-button mat-dialog-close>Close</button>
  </div>
</div>
